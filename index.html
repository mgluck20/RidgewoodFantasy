<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sleeper Fantasy League Dashboard</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { background-color: #f3f4f6; }
    .card { background-color: #fff; border-radius: 1rem; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 1.5rem; margin-bottom: 1.5rem; }
    .table th { background-color: #f9fafb; }
    .leaderboard-rank { font-weight: bold; color: #1f2937; }
    .highlight { color: #10b981; font-weight: bold; }
    .week-section { margin-bottom: 2rem; }
  </style>
</head>
<body class="p-6 font-sans">
  <header class="mb-8">
    <h1 class="text-3xl font-bold text-gray-800 mb-2">üèà Sleeper Fantasy League Dashboard</h1>
    <p class="text-gray-600">Real-time stats, standings, transactions, and bonuses.</p>
  </header>

  <!-- Money Leaderboard -->
  <section class="card">
    <h2 class="text-2xl font-semibold mb-4">üí∞ Money Leaderboard</h2>
    <table class="table-auto w-full text-left border-collapse border border-gray-200">
      <thead>
        <tr>
          <th class="border p-2">Rank</th>
          <th class="border p-2">Owner</th>
          <th class="border p-2">Team</th>
          <th class="border p-2">Total Bonuses</th>
          <th class="border p-2">Weekly Wins</th>
        </tr>
      </thead>
      <tbody id="leaderboard-body">
        <tr><td colspan="5" class="text-center p-4 text-gray-500">Loading leaderboard...</td></tr>
      </tbody>
    </table>
  </section>

  <!-- League Standings -->
  <section class="card">
    <h2 class="text-2xl font-semibold mb-4">üìä League Standings</h2>
    <table class="table-auto w-full text-left border-collapse border border-gray-200">
      <thead>
        <tr>
          <th class="border p-2">Rank</th>
          <th class="border p-2">Owner</th>
          <th class="border p-2">Team</th>
          <th class="border p-2">W-L-T</th>
          <th class="border p-2">Points For</th>
          <th class="border p-2">Points Against</th>
        </tr>
      </thead>
      <tbody id="standings-body">
        <tr><td colspan="6" class="text-center p-4 text-gray-500">Loading standings...</td></tr>
      </tbody>
    </table>
  </section>

  <!-- Weekly Winners -->
  <section class="card">
    <h2 class="text-2xl font-semibold mb-4">üèÜ Weekly High Score Winners</h2>
    <div id="weekly-winners" class="grid gap-4">
      <p class="text-gray-500">Loading weekly winners...</p>
    </div>
  </section>

  <!-- Matchups -->
  <section class="card">
    <h2 class="text-2xl font-semibold mb-4">‚öîÔ∏è Weekly Matchups</h2>
    <div id="matchups" class="space-y-4">
      <p class="text-gray-500">Loading matchups...</p>
    </div>
  </section>

  <!-- Recent Transactions -->
  <section class="card">
    <h2 class="text-2xl font-semibold mb-4">üìù Recent Transactions</h2>
    <ul id="transactions-list" class="list-disc pl-5 space-y-2">
      <li class="text-gray-500">Loading transactions...</li>
    </ul>
  </section>

  <!-- JavaScript to populate dashboard -->
  <script>
    function populateLeaderboard(data) {
      const tbody = document.getElementById('leaderboard-body');
      tbody.innerHTML = '';
      if (!data || data.length === 0) {
        tbody.innerHTML = '<tr><td colspan="5" class="text-center p-4 text-gray-500">No leaderboard data available</td></tr>';
        return;
      }
      data.forEach(entry => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="border p-2 leaderboard-rank">${entry.rank}</td>
          <td class="border p-2">${entry.display_name}</td>
          <td class="border p-2">${entry.team_name}</td>
          <td class="border p-2">$${entry.total_bonuses}</td>
          <td class="border p-2">${entry.wins}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function populateStandings(data) {
      const tbody = document.getElementById('standings-body');
      tbody.innerHTML = '';
      if (!data || data.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" class="text-center p-4 text-gray-500">No standings available</td></tr>';
        return;
      }
      data.forEach(entry => {
        const tr = document.createElement('tr');
        const record = `${entry.wins}-${entry.losses}${entry.ties > 0 ? '-' + entry.ties : ''}`;
        tr.innerHTML = `
          <td class="border p-2 leaderboard-rank">${entry.rank}</td>
          <td class="border p-2">${entry.display_name}</td>
          <td class="border p-2">${entry.team_name}</td>
          <td class="border p-2">${record}</td>
          <td class="border p-2">${entry.points_for.toFixed(2)}</td>
          <td class="border p-2">${entry.points_against.toFixed(2)}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function populateWeeklyWinners(data) {
      const container = document.getElementById('weekly-winners');
      container.innerHTML = '';
      if (!data || data.length === 0) {
        container.innerHTML = '<p class="text-gray-500">No weekly winners yet</p>';
        return;
      }
      data.forEach(w => {
        const div = document.createElement('div');
        div.className = 'p-4 bg-green-50 rounded-md';
        div.innerHTML = `<strong>Week ${w.week}</strong>: ${w.display_name} (${w.team_name}) scored <span class="highlight">${w.points}</span> points, won $${w.amount}`;
        container.appendChild(div);
      });
    }

    function populateTransactions(data) {
      const ul = document.getElementById('transactions-list');
      ul.innerHTML = '';
      if (!data || data.length === 0) {
        ul.innerHTML = '<li class="text-gray-500">No transactions yet</li>';
        return;
      }
      data.forEach(t => {
        const li = document.createElement('li');
        const date = new Date(t.timestamp).toLocaleDateString();
        li.textContent = `Week ${t.week}: ${t.type.toUpperCase()} (${t.status}) - ${date}, ${t.roster_count} roster(s)`;
        ul.appendChild(li);
      });
    }

    function populateMatchups(data) {
      const container = document.getElementById('matchups');
      container.innerHTML = '';
      if (!data || data.length === 0) {
        container.innerHTML = '<p class="text-gray-500">No matchups yet</p>';
        return;
      }
      data.forEach(week => {
        const section = document.createElement('div');
        section.className = 'week-section';
        const title = document.createElement('h3');
        title.className = 'font-semibold mb-2';
        title.textContent = `Week ${week.week}`;
        section.appendChild(title);
        week.matchups.forEach(m => {
          const p = document.createElement('p');
          p.textContent = `${m.roster_name}: ${m.points} pts ${m.win ? '(Win)' : ''}`;
          section.appendChild(p);
        });
        container.appendChild(section);
      });
    }

    // Dummy data injection (replace with google.script.run calls)
    const leaderboardData = window.leaderboard || [];
    const standingsData = window.standings || [];
    const winnersData = window.weeklyWinners || [];
    const transactionsData = window.recentTransactions || [];
    const matchupsData = window.matchups || [];

    populateLeaderboard(leaderboardData);
    populateStandings(standingsData);
    populateWeeklyWinners(winnersData);
    populateTransactions(transactionsData);
    populateMatchups(matchupsData);
  </script>
</body>
</html>
